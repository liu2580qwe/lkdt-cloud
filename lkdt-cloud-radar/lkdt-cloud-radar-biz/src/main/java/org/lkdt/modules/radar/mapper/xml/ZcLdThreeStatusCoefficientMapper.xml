<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.lkdt.modules.radar.mapper.ZcLdThreeStatusCoefficientMapper">

	<!-- 对P值分段(0.7-1.0之间，以每 0.01 为一段) 排序 -->
	<select id="queryByPElt" parameterType="java.util.Map" resultType="org.lkdt.modules.radar.entity.ZcLdThreeStatusCoefficient" >
		<![CDATA[
		SELECT
		    elt(
		        INTERVAL (coefficient_p, 0.69
						, 0.70, 0.71, 0.72, 0.73, 0.74, 0.75, 0.76, 0.77, 0.78, 0.79
						, 0.80, 0.81, 0.82, 0.83, 0.84, 0.85, 0.86, 0.87, 0.88, 0.89
						, 0.90, 0.91, 0.92, 0.93, 0.94, 0.95, 0.96, 0.97, 0.98, 0.99
						, 1.0),
						"0.69",
		        "0.70","0.71","0.72","0.73","0.74","0.75","0.76","0.77","0.78","0.79",
		        "0.80","0.81","0.82","0.83","0.84","0.85","0.86","0.87","0.88","0.89",
						"0.90","0.91","0.92","0.93","0.94","0.95","0.96","0.97","0.98","0.99",
						"1.0"
		    ) AS coefficient_p,
		    coefficient_g 
		FROM
		    zc_ld_three_status_coefficient
				where coefficient_p >= 0.70 and coefficient_p < 1.0 and coefficient_g is not null 
				and data_time > #{beginTime} and data_time <= #{endTime}
				and radar_id = #{radarId} and direction = #{direction}
		order by coefficient_p ,coefficient_g	
		]]>
	</select>
	
	
	<!-- 批量入库 -->
	<insert id="insertBatch" parameterType="org.lkdt.modules.radar.entity.ZcLdThreeStatusCoefficient">
		insert into zc_ld_three_status_coefficient(id,create_by,create_time,sys_org_code,radar_id,data_time,direction,coefficient_rsd,coefficient_v,coefficient_p,coefficient_g)
        VALUES
        <foreach collection="list" item="zList" separator =",">
            (
            #{zList.id}, #{zList.createBy}, #{zList.createTime},
			#{zList.sysOrgCode},
            #{zList.radarId}, #{zList.dataTime}, #{zList.direction},
            #{zList.coefficientRsd}, #{zList.coefficientV}, #{zList.coefficientP},
            #{zList.coefficientG} 
            )
        </foreach >
	</insert>
	
</mapper>